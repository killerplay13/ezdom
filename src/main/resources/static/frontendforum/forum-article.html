<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Around | Single Post v.1</title>
  <!-- SEO Meta Tags-->
  <meta name="description" content="Around - Multipurpose Bootstrap HTML Template">
  <meta name="keywords"
    content="bootstrap, business, corporate, coworking space, services, creative agency, dashboard, e-commerce, mobile app showcase, saas, multipurpose, product landing, shop, software, ui kit, web studio, landing, dark mode, html5, css3, javascript, gallery, slider, touch, creative">
  <meta name="author" content="Createx Studio">
  <!-- Viewport-->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Favicon and Touch Icons-->
  <link rel="apple-touch-icon" sizes="180x180" href="../frontendshop/assets/favicon/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="../frontendshop/assets/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="../frontendshop/assets/favicon/favicon-16x16.png">
  <link rel="manifest" href="../frontendshop/assets/favicon/site.webmanifest">
  <link rel="mask-icon" color="#6366f1" href="../frontendshop/assets/favicon/safari-pinned-tab.svg">
  <meta name="msapplication-TileColor" content="#080032">
  <meta name="msapplication-config" content="../frontendshop/assets/favicon/browserconfig.xml">
  <meta name="theme-color" content="white">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11.1.5/dist/sweetalert2.min.css">
  <!-- Theme mode-->
  <script>
    let mode = window.localStorage.getItem('mode'),
      root = document.getElementsByTagName('html')[0];
    if (mode !== undefined && mode === 'dark') {
      root.classList.add('dark-mode');
    } else {
      root.classList.remove('dark-mode');
    }


  </script>
  <!-- Page loading styles-->
  <style>
    .page-loading {
      position: fixed;
      top: 0;
      right: 0;
      bottom: 0;
      left: 0;
      width: 100%;
      height: 100%;
      -webkit-transition: all .4s .2s ease-in-out;
      transition: all .4s .2s ease-in-out;
      background-color: #fff;
      opacity: 0;
      visibility: hidden;
      z-index: 9999;
    }

    .dark-mode .page-loading {
      background-color: #121519;
    }

    .page-loading.active {
      opacity: 1;
      visibility: visible;
    }

    .page-loading-inner {
      position: absolute;
      top: 50%;
      left: 0;
      width: 100%;
      text-align: center;
      -webkit-transform: translateY(-50%);
      transform: translateY(-50%);
      -webkit-transition: opacity .2s ease-in-out;
      transition: opacity .2s ease-in-out;
      opacity: 0;
    }

    .page-loading.active>.page-loading-inner {
      opacity: 1;
    }

    .page-loading-inner>span {
      display: block;
      font-family: 'Inter', sans-serif;
      font-size: 1rem;
      font-weight: normal;
      color: #6f788b;
    }

    .dark-mode .page-loading-inner>span {
      color: #fff;
      opacity: .6;
    }

    .page-spinner {
      display: inline-block;
      width: 2.75rem;
      height: 2.75rem;
      margin-bottom: .75rem;
      vertical-align: text-bottom;
      background-color: #d7dde2;
      border-radius: 50%;
      opacity: 0;
      -webkit-animation: spinner .75s linear infinite;
      animation: spinner .75s linear infinite;
    }

    .dark-mode .page-spinner {
      background-color: rgba(255, 255, 255, .25);
    }

    @-webkit-keyframes spinner {
      0% {
        -webkit-transform: scale(0);
        transform: scale(0);
      }

      50% {
        opacity: 1;
        -webkit-transform: none;
        transform: none;
      }
    }

    @keyframes spinner {
      0% {
        -webkit-transform: scale(0);
        transform: scale(0);
      }

      50% {
        opacity: 1;
        -webkit-transform: none;
        transform: none;
      }
    }
  </style>
  <!-- Page loading scripts-->
  <script>
    (function () {
      window.onload = function () {
        const preloader = document.querySelector('.page-loading');
        preloader.classList.remove('active');
        setTimeout(function () {
          preloader.remove();
        }, 1500);
      };
    })();


  </script>
  <!-- Import Google Font-->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&amp;display=swap" rel="stylesheet"
    id="google-font">
  <!-- Vendor styles-->
  <link rel="stylesheet" media="screen" href="../frontendshop/assets/vendor/swiper/swiper-bundle.min.css" />
  <!-- Main Theme Styles + Bootstrap-->
  <link rel="stylesheet" media="screen" href="../frontendshop/assets/css/theme.min.css">
</head>
<!-- Body-->

<body>
  <!-- Page loading spinner-->
  <div class="page-loading active">
    <div class="page-loading-inner">
      <div class="page-spinner"></div><span>Loading...</span>
    </div>
  </div>
  <!-- Page wrapper-->
  <main class="page-wrapper">
    <!-- Navbar. Remove 'fixed-top' class to make the navigation bar scrollable with the page-->
    <header class="navbar navbar-expand-lg fixed-top navbar-ignore-dark-mode ignore-dark-mode" style="background-color: white;">
      <div class="container"><a class="navbar-brand pe-sm-3" href="/ezdom/ezdomindex.html"><span
              class="text-primary flex-shrink-0 me-2">
                    <svg version="1.1" width="35" height="32" viewBox="0 0 36 33" xmlns="http://www.w3.org/2000/svg">
                        <path fill="currentColor"
                              d="M35.6,29c-1.1,3.4-5.4,4.4-7.9,1.9c-2.3-2.2-6.1-3.7-9.4-3.7c-3.1,0-7.5,1.8-10,4.1c-2.2,2-5.8,1.5-7.3-1.1c-1-1.8-1.2-4.1,0-6.2l0.6-1.1l0,0c0.6-0.7,4.4-5.2,12.5-5.7c0.5,1.8,2,3.1,3.9,3.1c2.2,0,4.1-1.9,4.1-4.2s-1.8-4.2-4.1-4.2c-2,0-3.6,1.4-4,3.3H7.7c-0.8,0-1.3-0.9-0.9-1.6l5.6-9.8c2.5-4.5,8.8-4.5,11.3,0L35.1,24C36,25.7,36.1,27.5,35.6,29z">
                        </path>
                    </svg></span>EZ-DOM</a>
        <a class="btn btn-primary btn-sm fs-sm order-lg-3 d-none d-sm-inline-flex"
           href="/ezdom/frontendmember/account-overview.html" target="_blank"
           rel="noopener"><i class="ai-user"></i></a>
        <button class="navbar-toggler ms-sm-3" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarNav"><span class="navbar-toggler-icon"></span></button>
        <nav class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav navbar-nav-scroll me-auto" style="--ar-scroll-height: 520px;">
            <li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href="#" data-bs-toggle="dropdown"
                                             data-bs-auto-close="outside" aria-expanded="false">æªåœ˜</a>
              <ul class="dropdown-menu">
                <li class="dropdown"><a class="dropdown-item" href="/ezdom/group/grouplist.html">æªåœ˜åˆ—è¡¨</a></li>
                <li class="dropdown"><a class="dropdown-item" href="/ezdom/group/mygroup.html">Myæªåœ˜</a></li>
                <li class="dropdown" style="border-bottom: none;"><a class="dropdown-item dropdown-toggle"
                                                                     href="#" data-bs-toggle="dropdown" aria-expanded="false">é–‹åœ˜ç®¡ç†</a>
                  <ul class="dropdown-menu">
                    <li><a class="dropdown-item" href="/ezdom/groupcreate/groupcreate.html">å»ºç«‹æªåœ˜</a></li>
                    <li><a class="dropdown-item" href="/ezdom/groupcreate/groupCreateVerify.html">ç®¡ç†é–‹åœ˜</a></li>
                  </ul>
                </li>
                <li class="dropdown"><a class="dropdown-item" href="/ezdom/message/messageGroup.html">æªåœ˜èŠå¤©å®¤</a></li>
              </ul>
            </li>
            <li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href="#" data-bs-toggle="dropdown"
                                             data-bs-auto-close="outside" aria-expanded="false">å•†åŸ</a>
              <ul class="dropdown-menu">
                <li class="dropdown"><a class="dropdown-item" href="/ezdom/frontendshop/shop-catalog.html">ç€è¦½å•†å“</a></li>
                <li class="dropdown"><a class="dropdown-item" href="/ezdom/frontendshop/shop-account-orders.html">ç®¡ç†æˆ‘çš„è¨‚å–®</a></li>
              </ul>
            </li>
            <li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href="#" data-bs-toggle="dropdown"
                                             data-bs-auto-close="outside" aria-expanded="false">è«–å£‡</a>
              <ul class="dropdown-menu">
                <li class="dropdown"><a class="dropdown-item" href="/ezdom/frontendforum/forum.html">è«–å£‡</a></li>
                <li class="dropdown"><a class="dropdown-item" href="/ezdom/frontendforum/forum-mypost.html">æˆ‘çš„è«–å£‡</a></li>
                <li class="dropdown"><a class="dropdown-item" href="/ezdom/frontendforum/forum-post.html">ç™¼æ–‡</a></li>
              </ul>
            </li>
            <li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href="#" data-bs-toggle="dropdown"
                                             data-bs-auto-close="outside" aria-expanded="false">é ç´„</a>
              <ul class="dropdown-menu">
                <li class="dropdown"><a class="dropdown-item" href="/ezdom/frontendreserve/reserve-memberlist.html">é ç´„ç®¡ç†</a></li>
                <li class="dropdown"><a class="dropdown-item" href="/ezdom/frontendcoach/coach-list.html">ç€è¦½æ•™ç·´</a></li>
                <li class="dropdown"><a id="link" class="dropdown-item" href="/ezdom/frontendcoach/coach-details.html?coachId=">æ•™ç·´å°ˆå€</a></li>

              </ul>
            </li>
            <li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href="#" data-bs-toggle="dropdown"
                                             data-bs-auto-close="outside" aria-expanded="false">æœƒå“¡ä¸­å¿ƒ</a>
              <ul class="dropdown-menu">
                <li class="dropdown"><a class="dropdown-item" href="/ezdom/frontendmember/account-overview.html">æˆ‘çš„é é¢</a></li>
                <li class="dropdown"><a class="dropdown-item" href="/ezdom/frontendmember/account-settings.html">å€‹äººè¨­å®š</a></li>
                <li class="dropdown"><a class="dropdown-item" href="/ezdom/message/messagePrivate.html">èŠå¤©å®¤</a></li>
              </ul>
            </li>
            <li class="nav-item dropdown"><a class="nav-link " href="/ezdom/frontendsupport/support.html"
                                             aria-expanded="false">è¯çµ¡å®¢æœ</a>
            </li>
          </ul>
        </nav>
      </div>
    </header>
    <!-- Page content-->
    <!-- Page header-->
    <section class="container py-5 mt-5 mb-md-2 mb-lg-3 mb-xl-4">
      <!-- Breadcrumb-->
      <nav aria-label="breadcrumb">
        <ol class="pt-lg-3 pb-lg-4 pb-2 breadcrumb">
          <li class="breadcrumb-item"><a href="../ezdomindex.html">ä¸»é </a></li>
          <li class="breadcrumb-item"><a href="forum.html">è«–å£‡</a></li>
          <li class="breadcrumb-item active" aria-current="page">æ–‡ç« </li>
        </ol>
      </nav>

      <div id="article-info">
        <!-- å…¶ä»–æ–‡ç« è³‡è¨Š -->
      </div>
    </section>

    <!-- Post content-->
    <section class="container py-5 my-md-2 my-lg-3 my-xl-4">
      <div class="row pt-xxl-2">
        <div class="col-lg-9 col-xl-8 pe-lg-4 pe-xl-0 mx-auto w-75">
          <div class="card border-0 bg-secondary mb-3 ">
            <div class="card-body" id="article-content">
              <!-- æ–‡ç« å…§å®¹å°‡åœ¨é€™è£¡ç”Ÿæˆ -->
            </div>
          </div>
        </div>

      </div>
    </section>
    <!-- Comments-->
    <section class="container pt-xl-2 pb-5 mb-md-2 mb-lg-4 mb-xl-5" id="comments">
      <div class="border-top border-bottom">
        <!-- Comments collapse-->
        <div class="collapse" id="commentsCollapse" style="max-width: 54rem;">


          <div id="comment-section" class="border-bottom py-4 mt-2 mb-4">
            <!-- é€™è£¡å°‡æ·»åŠ ç•™è¨€å…§å®¹ -->
          </div>


        </div>

        <div class="nav" id="commentNav">
          <!-- ç•™è¨€æ•¸-->
        </div>


        <div class="card border-0 bg-secondary pt-2 p-md-2 p-xl-3 p-xxl-4 mt-n3 mt-md-0">
          <div class="card-body">
            <h2 class="pb-2 pb-lg-3 pb-xl-4">ç•™è¨€</h2>
            <form id="comment-form" class="row needs-validation g-4" novalidate>
              <div class="col-12">
                <textarea class="form-control" rows="4" placeholder="ç•™è¨€è¼¸å…¥" required id="message"></textarea>
                <div class="invalid-feedback">è«‹è¼¸å…¥ç•™è¨€!</div>
              </div>

              <div class="col-12">
                <button class="btn btn-primary" type="submit">ç™¼é€</button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </section>



  </main>
  <!-- Subscription-->

  <!-- Footer-->
  <footer class="footer bg-secondary py-5">
    <div class="container pt-1 pt-sm-2 pt-md-3 pt-lg-4 pt-xl-5">
      <div class="border-bottom text-center pb-4"><a class="navbar-brand d-inline-flex text-nav py-0 mb-3 mb-md-4"
          href="index.html"><span class="text-primary flex-shrink-0 me-2">
            <svg version="1.1" width="35" height="32" viewBox="0 0 36 33" xmlns="http://www.w3.org/2000/svg">
              <path fill="currentColor"
                d="M35.6,29c-1.1,3.4-5.4,4.4-7.9,1.9c-2.3-2.2-6.1-3.7-9.4-3.7c-3.1,0-7.5,1.8-10,4.1c-2.2,2-5.8,1.5-7.3-1.1c-1-1.8-1.2-4.1,0-6.2l0.6-1.1l0,0c0.6-0.7,4.4-5.2,12.5-5.7c0.5,1.8,2,3.1,3.9,3.1c2.2,0,4.1-1.9,4.1-4.2s-1.8-4.2-4.1-4.2c-2,0-3.6,1.4-4,3.3H7.7c-0.8,0-1.3-0.9-0.9-1.6l5.6-9.8c2.5-4.5,8.8-4.5,11.3,0L35.1,24C36,25.7,36.1,27.5,35.6,29z">
              </path>
            </svg></span><span>EZ-DOM</span></a>
        <ul class="nav justify-content-center py-1 pb-sm-2">
          <li class="nav-item"><a class="nav-link py-2 px-3 mx-1" href="#">Classes</a></li>
          <li class="nav-item"><a class="nav-link py-2 px-3 mx-1" href="#">Trainers</a></li>
          <li class="nav-item"><a class="nav-link py-2 px-3 mx-1" href="#">Schedule</a></li>
          <li class="nav-item"><a class="nav-link py-2 px-3 mx-1" href="#">Pricing</a></li>
          <li class="nav-item"><a class="nav-link py-2 px-3 mx-1" href="#">Contact</a></li>
        </ul>
      </div>
      <div class="d-sm-flex align-items-center justify-content-between pt-4 mt-2 mt-sm-0">
        <div class="d-flex justify-content-center order-sm-2 mb-4 mb-sm-0"><a
            class="btn btn-icon btn-sm btn-secondary btn-instagram rounded-circle me-3" href="#"><i
              class="ai-instagram"></i></a><a class="btn btn-icon btn-sm btn-secondary btn-facebook rounded-circle me-3"
            href="#"><i class="ai-facebook"></i></a><a
            class="btn btn-icon btn-sm btn-secondary btn-youtube rounded-circle" href="#"><i class="ai-youtube"></i></a>
        </div>
        <p class="fs-sm order-sm-1 text-center mb-0"><span class="opacity-70">&copy; All rights reserved. Made by
          </span><a class="nav-link d-inline fw-normal p-0" href="https://createx.studio/" target="_blank"
            rel="noopener">Createx Studio</a></p>
      </div>
    </div>
  </footer>
  <!-- Back to top button--><a class="btn-scroll-top" href="#top" data-scroll>
    <svg viewBox="0 0 40 40" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
      <circle cx="20" cy="20" r="19" fill="none" stroke="currentColor" stroke-width="1.5" stroke-miterlimit="10">
      </circle>
    </svg><i class="ai-arrow-up"></i></a>
  <!-- Vendor scripts: js libraries and plugins-->
  <script src="../frontendshop/assets/vendor/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
  <script src="../frontendshop/assets/vendor/smooth-scroll/dist/smooth-scroll.polyfills.min.js"></script>
  <script src="../frontendshop/assets/vendor/jarallax/dist/jarallax.min.js"></script>
  <script src="../frontendshop/assets/vendor/swiper/swiper-bundle.min.js"></script>
  <!-- Main theme script-->
  <script src="../frontendshop/assets/js/theme.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.1.5/dist/sweetalert2.all.min.js"></script>
  <script>
    // ====================== å–å¾—ç™»å…¥çš„sessionè³‡è¨Š ====================== //
                window.addEventListener("load", function() {
                        getSession();
                    })
              const s_req = '/ezdom/frontend/session';
              let session;
              let memberId = null;
              let coachId = null;
              async function getSession(){
                  let response = await fetch(s_req);
                  session = await response.json();
                  console.log(session);
                  memberId = session.memberId;
                  if(null !== session.coachId){
                      coachId = session.coachId;
                  }

                  let link = document.querySelector("#link");
                  if(null !== coachId){
                  console.log("1:" + coachId);
                    link.setAttribute("href", `/ezdom/frontendcoach/coach-details.html?coachId=${coachId}`);
                  } else if (null === coachId){
                  console.log("2:" + coachId);
                    link.setAttribute("href", `/ezdom/frontendcoach/coach-signup.html`);
                    link.textContent = "è¨»å†Šæ•™ç·´";
                  }
              }
  </script>


  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const urlParams = new URLSearchParams(window.location.search);
      const postId = urlParams.get('postId');

      // ====================== é¡¯ç¤ºæ–‡ç« å…§å®¹ ====================== // 
      if (postId) {
        //ä½¿ç”¨postIdä¾†ç²å–æ–‡ç« å…§å®¹
        fetch(`/ezdom/frontend/forum/get/${postId}`)
          .then(response => {
            if (response.status === 401) {
              //é‡å®šå‘åˆ°ç™»å…¥é é¢ ç™»å…¥å¤±æ•—
              window.location.href = '/ezdom/frontendmember/account-signin.html';
            } else if (response.ok) {
              //ç™»å…¥æˆåŠŸ
              return response.json();
            }
          })
          .then(article => {
            const {
              forumPostTitle,
              forumPostContent,
              forumPostTime,
              forumPostType,
              memberName,
              memberPhoto,
              memberId,
            } = article;

            let imgUrl = "data:image/jpeg;base64," + memberPhoto;
            const articleInfo = document.getElementById('article-info');
            const articleContent = document.getElementById('article-content');
            articleInfo.innerHTML = `           
            <h1 class="display-4 pb-2 pb-lg-3 mx-auto w-75" id="article-title style="overflow-wrap: break-word;" >${forumPostTitle}</h1>
            <div class="d-flex flex-wrap align-items-center mt-n2 mx-auto w-75">             
              <a class="nav-link position-relative text-muted fs-sm fw-normal d-flex align-items-end p-0 mt-2" href="#comments" data-scroll data-scroll-offset="60"></a>
                <a href="/ezdom/frontendmember/personalPage.html?memberId=${memberId}">
                    <img class="rounded-circle" src="${imgUrl}" width="48" alt="Comment author">
                     </a>
              <a class="badge text-nav fs-xs border mt-2" id="post-status">âœï¸${memberName}</a>             
              <span class="fs-xs opacity-20 mt-2 mx-3">|</span>
              <a class="badge text-nav fs-xs border mt-2 " id="post-status">${getPostStatusText(forumPostType)}</a>
              <span class="fs-xs opacity-20 mt-2 mx-3">|</span>
              <a class="badge text-nav fs-xs border mt-2" id="post-status">ğŸ“…${formatDate(forumPostTime)}</a>
            </div>`;

            articleContent.innerHTML = `<div class="article-content" style=" color: #000;">
              ${UrlS(forumPostContent)}</div>`;

            function UrlS(text) {
              //å°‡ç¶²å€è½‰æ›ç‚ºè¶…é€£çµ
              const urlPattern = /(https?:\/\/[^\s]+)/g;
              const textWithLinks = text.replace(urlPattern, '<a href="$1" target="_blank">$1</a>');

              //ä½¿ç”¨æ­£å‰‡è¡¨é”å¼/\n/gä¾†æŸ¥æ‰¾ä¸¦æ›¿æ›forumPostContentä¸­çš„æ›è¡Œç¬¦ï¼ˆ\nï¼‰ç‚º<br>æ¨™ç±¤
              return textWithLinks.replace(/\n/g, '<br>');
            }

          })
          .catch(error => {
            console.error('Error fetching article content:', error);
          });


        // ====================== é¡¯ç¤ºæ–‡ç« ç•™è¨€ ====================== // 
        fetch(`/ezdom/frontend/forum/current-member-id`)
          .then(response => response.json())
          .then(currentMemberId => {//åˆ¤æ–·ç•¶å‰ç™»å…¥idè·Ÿç•™è¨€è€…çš„idæ˜¯å¦ç›¸åŒ
            fetch(`/ezdom/frontend/forum/msg/forumPost/${postId}`)
              .then(response => {
                if (response.status === 401) {
                  //é‡å®šå‘åˆ°ç™»å…¥é é¢ ç™»å…¥å¤±æ•—
                  window.location.href = '/ezdom/frontendmember/account-signin.html';
                } else if (response.ok) {
                  //ç™»å…¥æˆåŠŸ
                  return response.json();
                }
              })
              .then(messages => {
                const commentSection = document.getElementById('comment-section');
                const commentNav = document.getElementById('commentNav');
                const commentCount = messages.length;

                for (let message of messages) {
                  const {
                    forumMsgId,
                    memberId,
                    memberName,
                    forumMsgTime,
                    forumMsgContent,
                    forumPostStatus,
                    memberPhoto
                  } = message;

                  let imgUrl = "data:image/jpeg;base64," + memberPhoto;

                  const commentContainer = document.createElement('div');
                  let deleteButtonHtml = '';
                  if (currentMemberId === memberId) {
                    deleteButtonHtml = `<button type="button" class="btn btn-outline-danger"  onclick="deleteMessage(${forumMsgId})">åˆªé™¤</button>`
                  }
                  commentContainer.innerHTML = `
                    <div class="border-bottom py-4 mt-2 mb-4">  
                      <div class="d-flex align-items-center pb-1 mb-3">
                          <a href="/ezdom/frontendmember/personalPage.html?memberId=${memberId}">
                    <img class="rounded-circle" src="${imgUrl}" width="48" alt="Comment author">
                     </a>
                        <div class="ps-3">
                          <h6 class="mb-0">${memberName}</h6>                        
                          <span class="fs-sm text-muted">ğŸ“…${formatDate(forumMsgTime)}</span>
                        </div>                       
                      </div>
                      <div class="d-flex justify-content-between">
                        <p class="pb-2 mb-0">${forumMsgContent}</p>                    
                        ${deleteButtonHtml}                        
                      </div>
                    </div>`;

                  commentNav.innerHTML = `                 
                  <button class="btn-more nav-link collapsed w-100 justify-content-center p-3" type="button"
                    data-bs-toggle="collapse" data-bs-target="#commentsCollapse" aria-expanded="false"
                    aria-controls="commentsCollapse" data-show-label="é¡¯ç¤º" data-hide-label="éš±è—">
                    <span class="fw-normal ms-1">${commentCount} å‰‡ç•™è¨€</span>
                  </button>`;

                  commentSection.appendChild(commentContainer);
                }
              })
              .catch(error => {
                console.error('Error fetching comments:', error);
              });
          })
          .catch(error => {
            console.error('Error fetching current member ID:', error);
          });
      }


      // ====================== é€²è¡Œç•™è¨€ ====================== //   
      const form = document.getElementById('comment-form');
      form.addEventListener('submit', function (event) {
        event.preventDefault(); //é˜»æ­¢è¡¨å–®çš„é»˜èªæäº¤è¡Œç‚º

        const messageElement = document.getElementById('message');
        if (messageElement) {
          const content = messageElement.value;

          //æª¢æŸ¥ç•™è¨€å…§å®¹æ˜¯å¦ç‚ºç©º
          if (!content) {
            Swal.fire({
              icon: 'error',
              title: 'éŒ¯èª¤',
              text: 'è«‹è¼¸å…¥ç•™è¨€å…§å®¹',
            });
          } else {
            const commentData = {
              forumPostId: postId,
              forumMsgContent: content,
            };
            fetch('/ezdom/frontend/forum/msg', {
              method: 'POST',
              headers: {
                'Content-Type': 'application/json',
              },
              body: JSON.stringify(commentData),
            })
              .then(response => {
                if (response.status === 401) {
                  //é‡å®šå‘åˆ°ç™»å…¥é é¢ ç™»å…¥å¤±æ•—
                  window.location.href = '/ezdom/frontendmember/account-signin.html';
                } else if (response.ok) {
                  //ç™»å…¥æˆåŠŸ
                  return response.json();
                }
              })
              .then((data) => {
                if (data.successful) {
                  Swal.fire({
                    icon: 'success',
                    title: 'æˆåŠŸ',
                    text: data.message,
                  }).then(() => {
                    location.reload();//åˆ·æ–°ç•¶å‰é é¢
                  });
                } else {
                  Swal.fire({
                    icon: 'error',
                    title: 'éŒ¯èª¤',
                    text: data.message,
                  });
                }
              })
              .catch((error) => {
                console.error('ç™¼é€ç•™è¨€æ™‚å‡ºéŒ¯:', error);
                Swal.fire({
                  icon: 'error',
                  title: 'éŒ¯èª¤',
                  text: 'ç™¼é€ç•™è¨€æ™‚å‡ºéŒ¯ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚',
                });
              });
          }
        } else {
          console.error('Element with id "message" not found.');
        }
      });
    });


    // ====================== ç•™è¨€åˆªé™¤ ====================== //      
    function deleteMessage(msgId) {
      Swal.fire({
        title: 'ç¢ºå®šè¦åˆªé™¤é€™å‰‡ç•™è¨€å—ï¼Ÿ',
        icon: 'warning',
        showCancelButton: true,
        confirmButtonText: 'ç¢ºå®š',
        cancelButtonText: 'å–æ¶ˆ'
      }).then((result) => {
        if (result.isConfirmed) {
          fetch(`/ezdom/frontend/forum/delete/msg/${msgId}`, {
            method: 'DELETE'
          })
            .then(response => {
              if (response.status === 401) {
                //é‡å®šå‘åˆ°ç™»å…¥é é¢ ç™»å…¥å¤±æ•—
                window.location.href = '/ezdom/frontendmember/account-signin.html';
              } else if (response.ok) {
                //ç™»å…¥æˆåŠŸ
                return response.json();
              }
            })
            .then(data => {
              if (data.successful !== undefined && data.successful === true) {
                Swal.fire({
                  title: data.message,
                  icon: 'success'
                }).then(() => {
                  window.location.reload();
                });
              } else {
                Swal.fire({
                  title: 'åˆªé™¤å¤±æ•—',
                  text: data.message || 'åˆªé™¤å¤±æ•—ï¼Œè«‹é‡è©¦',
                  icon: 'error'
                });
                console.error('Delete failed:', data);
              }
            })
            .catch(error => {
              console.error('Error deleting collected post:', error);
              Swal.fire({
                title: 'ç™¼ç”ŸéŒ¯èª¤',
                text: 'è«‹ç¨å¾Œå†è©¦',
                icon: 'error'
              });
            });
        }
      });
    }

    //æ›´æ›æ—¥æœŸæ™‚é–“é¡¯ç¤ºæ ¼å¼
    function formatDate(dateTime) {
      const options = { year: 'numeric', month: 'short', day: 'numeric', hour: 'numeric', minute: 'numeric', second: 'numeric', hour12: false };
      return new Date(dateTime).toLocaleDateString('en-US', options);
    }

    //å°‡ç‹€æ…‹è½‰æ›ç‚ºæ–‡å­—é¡¯ç¤º
    function getPostStatusText(forumPostType) {
      switch (forumPostType) {
        case 1:
          return 'ğŸƒæˆ¶å¤–é‹å‹•';
        case 2:
          return 'ğŸ‹ï¸â€â™‚ï¸å®¤å…§å¥èº«';
        case 3:
          return 'ğŸ§—â€â™‚ï¸æ¥µé™é‹å‹•';
        case 4:
          return 'ğŸŠæ°´ä¸Šé‹å‹•';
        case 5:
          return 'ğŸ¥Šæ ¼é¬¥';
        case 6:
          return 'ğŸ”é£²é£Ÿ';
        default:
          return 'å…¶ä»–ç‹€æ…‹';
      }
    }


  </script>
</body>

</html>